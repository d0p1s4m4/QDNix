<!doctype html>
<html lang="en-us">
  <head>
    
    <meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
    <title>
      Quick&#39;n&#39;dirty *NIX
      
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="contact@qdnix.d0p1.eu" />
    <meta name="description" content="Portable UNIX-like Operating System" />
    
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.css" />
    <link rel="stylesheet" href="https://qdnix.d0p1.eu/static/style.css" type="text/css" />
    
  </head>
  <body>
    
    
      <header class="navbar">
		<nav aria-label="Main navigation">
			<div class="navbar-brand">
				<h1><a href="https://qdnix.d0p1.eu/" title="Quick'n'dirty *NIX">Quick&#39;n&#39;dirty *NIX</a></h1>
			</div>
			<ul>
				<li><a href="https://qdnix.d0p1.eu/">Home</a></li>
				<li><a href="https://qdnix.d0p1.eu/propaganda.html">Propaganda</a></li>
				<li><a href="https://qdnix.d0p1.eu/man">Manual</a></li>
				<li><a href="https://qdnix.d0p1.eu/doxygen">Doxygen</a></li>
			</ul>
		</nav>
      </header>
    

	<div class="page">
	  
    <main id="main">
      
  <article class="page">
    <section>
      <!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>ffi_call(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">ffi_call(3)</td>
    <td class="head-vol">Library Functions Manual</td>
    <td class="head-rtitle">ffi_call(3)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp"><code class="Nm">ffi_call</code> &#x2014; <span class="Nd">Invoke
    a foreign function.</span></p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp"><code class="In">#include
  &lt;<a class="In">ffi.h</a>&gt;</code></p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">ffi_call</code>(<var class="Fa">ffi_cif *cif</var>,
    <var class="Fa">void (*fn)(void)</var>, <var class="Fa">void *rvalue</var>,
    <var class="Fa">void **avalue</var>);</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">The <code class="Nm">ffi_call</code> function provides a simple
    mechanism for invoking a function without requiring knowledge of the
    function's interface at compile time. <var class="Fa">fn</var> is called
    with the values retrieved from the pointers in the
    <var class="Fa">avalue</var> array. The return value from
    <var class="Fa">fn</var> is placed in storage pointed to by
    <var class="Fa">rvalue</var>. <var class="Fa">cif</var> contains information
    describing the data types, sizes and alignments of the arguments to and
    return value from <var class="Fa">fn</var>, and must be initialized with
    <code class="Nm">ffi_prep_cif</code> before it is used with
    <code class="Nm">ffi_call</code>.</p>
<p class="Pp"><var class="Fa">rvalue</var> must point to storage that is
    sizeof(ffi_arg) or larger for non-floating point types. For smaller-sized
    return value types, the <code class="Nm">ffi_arg</code> or
    <code class="Nm">ffi_sarg</code> integral type must be used to hold the
    return value.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h1>
<div class="Bd Li">
<pre>#include &lt;ffi.h&gt;
#include &lt;stdio.h&gt;

unsigned char
foo(unsigned int, float);

int
main(int argc, const char **argv)
{
    ffi_cif cif;
    ffi_type *arg_types[2];
    void *arg_values[2];
    ffi_status status;

    // Because the return value from foo() is smaller than sizeof(long), it
    // must be passed as ffi_arg or ffi_sarg.
    ffi_arg result;

    // Specify the data type of each argument. Available types are defined
    // in &lt;ffi/ffi.h&gt;.
    arg_types[0] = &amp;ffi_type_uint;
    arg_types[1] = &amp;ffi_type_float;

    // Prepare the ffi_cif structure.
    if ((status = ffi_prep_cif(&amp;cif, FFI_DEFAULT_ABI,
        2, &amp;ffi_type_uint8, arg_types)) != FFI_OK)
    {
        // Handle the ffi_status error.
    }

    // Specify the values of each argument.
    unsigned int arg1 = 42;
    float arg2 = 5.1;

    arg_values[0] = &amp;arg1;
    arg_values[1] = &amp;arg2;

    // Invoke the function.
    ffi_call(&amp;cif, FFI_FN(foo), &amp;result, arg_values);

    // The ffi_arg 'result' now contains the unsigned char returned from foo(),
    // which can be accessed by a typecast.
    printf(&quot;result is %hhu&quot;, (unsigned char)result);

    return 0;
}

// The target function.
unsigned char
foo(unsigned int x, float y)
{
    unsigned char result = x - y;
    return result;
}</pre>
</div>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp"><a class="Xr">ffi(3)</a>, <a class="Xr">ffi_prep_cif(3)</a></p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">February 15, 2008</td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>

    </section>
  </article>

    </main>

    
	<footer>
		<p class="button">
			<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">
				<img alt="Creative Commons License" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" />
			</a>
			<a href="https://emacs.love/weblorg/" target="_blank">
				<img alt="Created with emacs" src="https://qdnix.d0p1.eu/static/img/button/emacs.gif" />
			</a>
			<a href="http://d0p1.eu/trans-rights-are-human-rights" target="_blank">
				<img alt="Trans right now!" src="https://qdnix.d0p1.eu/static/img/button/trn.png" />
			</a>
			<a href="https://web3isgoinggreat.com/" target="_blank">
				<img alt="This is an Anti-NFT site" src="https://qdnix.d0p1.eu/static/img/button/antinft.gif" />
			</a>
			<a href="https://www.defectivebydesign.org/" target="_blank">
				<img src="https://defectivebydesign.org/sites/nodrm.civicactions.net/files/images/elim_sm_btn.gif"
					alt="Eliminate DRM!" width="88" height="31" />
			</a>
			<a href="https://yesterweb.org/no-to-web3/" target="_blank">
				<img alt="Say no to web3" src="https://qdnix.d0p1.eu/static/img/button/roly-saynotoweb3.gif" />
			</a>
			<a href="https://www.youtube.com/watch?v=_Rua3TOeono" target="_blank">
				<img src="https://qdnix.d0p1.eu/static/img/button/nonazis.png" width="31" />
			</a>
			<a href="https://endsoftwarepatents.org/innovating-without-patents" target="_blank">
				<img alt="End of software patents" style="height: 31px;"
					src="https://static.fsf.org/nosvn/esp/logos/patent-free.svg">
			</a>
			<a href="https://liberapay.com/d0p1/donate" target="_blank">
				<img alt="Donate using Liberapay" src="https://liberapay.com/assets/widgets/donate.svg"></a>
			<br />
		</p>
	</footer>
    
	</div>

	
  </body>
</html>
